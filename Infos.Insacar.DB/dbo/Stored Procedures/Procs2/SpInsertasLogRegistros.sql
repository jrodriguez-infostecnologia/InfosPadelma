CREATE PROCEDURE SpInsertasLogRegistros @empresa int,@fecha datetime,@usuario varchar(50),@operacion varchar(50),@entidad varchar(250),@mensajeSistema varchar(500),@ip varchar(50),@estado char(10),@Retorno int output  AS begin tran sLogRegistros insert sLogRegistros( empresa,fecha,usuario,operacion,entidad,mensajeSistema,ip,estado ) select @empresa,@fecha,@usuario,@operacion,@entidad,@mensajeSistema,@ip,@estado if (@@error = 0 ) begin set @Retorno = 0 commit tran sLogRegistros end else begin set @Retorno = 1 rollback tran sLogRegistros end